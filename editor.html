<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Guide - PoE2 Campaign Guide</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Top Bar -->
    <header class="top-bar">
        <div class="user-section">
            <a href="index.html" class="btn btn-secondary">‚Üê Back</a>
            <span id="currentUserDisplay" style="margin-left: 10px;">No user selected</span>
        </div>
        <div class="top-actions">
            <button class="theme-toggle" id="themeToggle">üåô</button>
        </div>
    </header>

    <!-- Sidebar Navigation (same as main) -->
    <nav class="sidebar">
        <div class="sidebar-title">Campaign</div>
        <div class="nav-item active" data-act="act1">Act 1</div>
        <div class="nav-item" data-act="act2">Act 2</div>
        <div class="nav-item" data-act="act3">Act 3</div>
        <div class="nav-item" data-act="act4">Act 4</div>
        <div class="nav-item" data-act="interlude1">Interlude I</div>
        <div class="nav-item" data-act="interlude2">Interlude II</div>
        <div class="nav-item" data-act="interlude3">Interlude III</div>
    </nav>

    <!-- Editor Layout -->
    <div class="editor-layout">
        <!-- Left Panel - Section List -->
        <aside class="editor-sidebar">
            <div class="bulk-actions-bar" id="bulkActionsBar">
                <button class="btn btn-small" id="bulkSelectBtn" title="Select multiple sections to copy">‚òë Select</button>
                <button class="btn btn-small" id="linkSectionsBtn" title="Link sections together">üîó Link</button>
                <div class="bulk-actions-active" id="bulkActionsActive" style="display: none;">
                    <span class="bulk-count" id="bulkCount">0 selected</span>
                    <button class="btn btn-small" id="bulkCopyBtn">Copy to Act</button>
                    <button class="btn btn-small btn-secondary" id="bulkCancelBtn">Cancel</button>
                </div>
                <div class="link-mode-active" id="linkModeActive" style="display: none;">
                    <div class="link-color-picker" id="linkColorPicker"></div>
                    <span class="link-count" id="linkCount">0 in chain</span>
                    <button class="btn btn-small" id="saveLinkBtn">Save Link</button>
                    <button class="btn btn-small btn-secondary" id="cancelLinkBtn">Cancel</button>
                </div>
            </div>

            <div class="form-group">
                <label>Act</label>
                <select id="actSelect">
                    <option value="act1">Act 1</option>
                    <option value="act2">Act 2</option>
                    <option value="act3">Act 3</option>
                    <option value="act4">Act 4</option>
                    <option value="interlude1">Interlude I</option>
                    <option value="interlude2">Interlude II</option>
                    <option value="interlude3">Interlude III</option>
                </select>
            </div>

            <button class="btn" id="newSectionBtn" style="width: 100%; margin-bottom: 15px;">+ New Section</button>

            <div class="existing-links" id="existingLinks" style="display: none;">
                <div class="existing-links-title">Linked Chains</div>
                <div class="existing-links-list" id="existingLinksList"></div>
            </div>

            <div class="section-list" id="sectionList">
                <!-- Sections will be rendered here -->
            </div>
        </aside>

        <!-- Main Editor Area -->
        <main class="editor-main">
            <div id="editorPanel" style="display: none;">
                <div class="form-group">
                    <label for="sectionTitle">Section Title</label>
                    <input type="text" id="sectionTitle" placeholder="Enter section title">
                </div>

                <div class="form-group">
                    <label>Content</label>
                    <div class="editor-toolbar">
                        <button type="button" class="toolbar-btn" data-cmd="bold" title="Bold"><b>B</b></button>
                        <button type="button" class="toolbar-btn" data-cmd="italic" title="Italic"><i>I</i></button>
                        <button type="button" class="toolbar-btn" data-cmd="underline" title="Underline"><u>U</u></button>
                        <button type="button" class="toolbar-btn" data-cmd="insertUnorderedList" title="Bullet List">‚Ä¢ List</button>
                        <button type="button" class="toolbar-btn" data-cmd="insertOrderedList" title="Numbered List">1. List</button>
                        <button type="button" class="toolbar-btn" id="insertImageBtn" title="Insert Image">üñº Image</button>
                        <input type="file" id="imageInput" accept="image/*" style="display: none;">
                    </div>
                    <div class="editor-content" id="editorContent" contenteditable="true"></div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <button class="btn" id="saveBtn">Save</button>
                    <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button class="btn btn-secondary" id="copyToActBtn">Copy to Act</button>
                    <button class="btn btn-danger" id="deleteBtn" style="margin-left: auto;">Delete</button>
                </div>
            </div>

            <div class="empty-state" id="editorEmptyState">
                <h3>Select or create a section</h3>
                <p>Choose a section from the left panel or click "+ New Section" to create one.</p>
            </div>
        </main>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal" style="display: none;">
        <div class="modal">
            <h3>Delete Section</h3>
            <p>Are you sure you want to delete this section? This cannot be undone.</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelDelete">Cancel</button>
                <button class="btn btn-danger" id="confirmDelete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Copy to Act Modal -->
    <div class="modal-overlay" id="copyModal" style="display: none;">
        <div class="modal">
            <h3>Copy Section to Act</h3>
            <div class="form-group">
                <label for="copyTargetAct">Select target act</label>
                <select id="copyTargetAct">
                    <option value="act1">Act 1</option>
                    <option value="act2">Act 2</option>
                    <option value="act3">Act 3</option>
                    <option value="act4">Act 4</option>
                    <option value="interlude1">Interlude I</option>
                    <option value="interlude2">Interlude II</option>
                    <option value="interlude3">Interlude III</option>
                </select>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelCopy">Cancel</button>
                <button class="btn" id="confirmCopy">Copy</button>
            </div>
        </div>
    </div>

    <!-- Bulk Copy Modal -->
    <div class="modal-overlay" id="bulkCopyModal" style="display: none;">
        <div class="modal">
            <h3>Copy Sections to Act</h3>
            <p id="bulkCopyCount" style="margin-bottom: 15px; color: var(--text-secondary);">0 sections selected</p>
            <div class="form-group">
                <label for="bulkCopyTargetAct">Select target act</label>
                <select id="bulkCopyTargetAct">
                    <option value="act1">Act 1</option>
                    <option value="act2">Act 2</option>
                    <option value="act3">Act 3</option>
                    <option value="act4">Act 4</option>
                    <option value="interlude1">Interlude I</option>
                    <option value="interlude2">Interlude II</option>
                    <option value="interlude3">Interlude III</option>
                </select>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelBulkCopy">Cancel</button>
                <button class="btn" id="confirmBulkCopy">Copy All</button>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/editor.js"></script>
</body>
</html>
